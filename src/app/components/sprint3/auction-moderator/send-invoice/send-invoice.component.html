<div class="col-12 mt-1">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb px-0">
            <li class="breadcrumb-item"><a [href]="getHomeUrl">{{'auctionCommittee.ac-detail.bcrumb1' |
                    translate}}</a></li>
            <li class="breadcrumb-item"><a href="/auctions">{{'auctionCommittee.ac-detail.bcrumb2' |
                    translate}}</a></li>
            <li class="breadcrumb-item"><a (click)="goToAuctionDetails()">{{'auctionCommittee.ac-detail.bcrumb3' |
                    translate}}</a></li>
            <li class="breadcrumb-item active" aria-current="page">
                {{'bidderAuctions.payment_bill' | translate}}</li>
        </ol>
    </nav>
</div>


<div class="col-12 border-bottom pb-2 mt-4">
    <div class="row">
        <div class="col-md-12">
            <h1 class="text-20 text-primary font-weight-500">{{'bidderAuctions.payment_bill' | translate}}</h1>
        </div>
    </div>
</div>


<div class="mt-5 mb-4 pb-2" style=" width: 896px; padding-left: 10%; padding-right: 10%;">
    <p class="text-success text-24 font-weight-bold">{{'bidderFinalInvoice.InvoiceInformation' |
        translate}}</p>
</div>


<div class="" style="padding-left: 10%; padding-right: 10%;">

    <div class="border rounded" style="width: 896px; background-color: #FFFFFF;">

        <div class="card p-5 shadow-lg" *ngIf="showLoader">
            <div class="form-row">
                <div class="col-12">
                    <table class="table">
                        <td colspan="10" class="p-3 bg-white">
                            <div class="alert-body text-center">
                                <i class="alert-icon">
                                    <svg class="et-spinner" width="64" height="64" xmlns="http://www.w3.org/2000/svg">
                                        <g fill-rule="nonzero" fill="#32AD71">
                                            <path
                                                d="M32 11.871c-1.755 0-3.097-1.342-3.097-3.097V3.097C28.903 1.342 30.245 0 32 0s3.097 1.342 3.097 3.097v5.677c0 1.652-1.342 3.097-3.097 3.097z" />
                                            <path
                                                d="M32 64c-1.755 0-3.097-1.342-3.097-3.097v-5.677c0-1.755 1.342-3.097 3.097-3.097s3.097 1.342 3.097 3.097v5.677C35.097 62.658 33.755 64 32 64z"
                                                opacity=".4" />
                                            <path
                                                d="M46.452 60.077c-1.033 0-2.065-.516-2.684-1.548l-2.787-4.852c-.826-1.445-.31-3.406 1.135-4.232 1.445-.826 3.407-.31 4.232 1.136l2.787 4.851c.826 1.445.31 3.407-1.135 4.233a2.913 2.913 0 01-1.548.412z"
                                                opacity=".5" />
                                            <path
                                                d="M11.871 23.432a2.913 2.913 0 01-1.548-.413L5.47 20.232C4.026 19.406 3.51 17.445 4.335 16c.826-1.445 2.788-1.961 4.233-1.135l4.851 2.787c1.446.825 1.962 2.787 1.136 4.232-.62 1.032-1.652 1.548-2.684 1.548z"
                                                opacity=".05" />
                                            <path
                                                d="M57.084 49.548a2.913 2.913 0 01-1.549-.413l-4.954-2.787c-1.446-.825-1.962-2.787-1.136-4.232.826-1.445 2.787-1.961 4.232-1.135l4.852 2.787c1.445.826 1.961 2.787 1.136 4.232-.517 1.032-1.549 1.548-2.581 1.548z"
                                                opacity=".6" />
                                            <path
                                                d="M8.774 35.097H3.097C1.342 35.097 0 33.755 0 32s1.342-3.097 3.097-3.097h5.677c1.755 0 3.097 1.342 3.097 3.097s-1.445 3.097-3.097 3.097z"
                                                opacity=".1" />
                                            <path
                                                d="M60.903 35.097h-5.677c-1.755 0-3.097-1.342-3.097-3.097s1.342-3.097 3.097-3.097h5.677C62.658 28.903 64 30.245 64 32s-1.342 3.097-3.097 3.097z"
                                                opacity=".7" />
                                            <path
                                                d="M6.916 49.548c-1.032 0-2.064-.516-2.684-1.548-.826-1.445-.31-3.406 1.136-4.232l4.851-2.787c1.446-.826 3.407-.31 4.233 1.135.825 1.445.31 3.407-1.136 4.232l-4.851 2.787c-.413.31-.93.413-1.549.413z"
                                                opacity=".2" />
                                            <path
                                                d="M52.129 23.432c-1.032 0-2.064-.516-2.684-1.548-.826-1.445-.31-3.407 1.136-4.232l4.851-2.787c1.445-.826 3.407-.31 4.233 1.135.825 1.445.31 3.406-1.136 4.232l-4.852 2.787a2.913 2.913 0 01-1.548.413z"
                                                opacity=".8" />
                                            <path
                                                d="M17.548 60.077A2.913 2.913 0 0116 59.665c-1.445-.826-1.961-2.788-1.135-4.233l2.787-4.851c.825-1.446 2.787-1.962 4.232-1.136 1.445.826 1.961 2.787 1.135 4.232l-2.787 4.852c-.62 1.032-1.651 1.548-2.684 1.548z"
                                                opacity=".3" />
                                            <path
                                                d="M43.665 14.968a2.913 2.913 0 01-1.549-.413c-1.445-.826-1.961-2.787-1.135-4.232l2.787-4.852C44.594 4.026 46.555 3.51 48 4.335c1.445.826 1.961 2.788 1.135 4.233l-2.787 4.851c-.619.93-1.651 1.549-2.683 1.549z"
                                                opacity=".9" />
                                        </g>
                                    </svg>
                                </i>
                                <div class="alert-content">
                                    <h5 class="text-black-50">Loading</h5>
                                </div>
                            </div>
                        </td>
                    </table>
                </div>
            </div>
        </div>

        <div style="margin: 6%;" *ngIf="!showLoader">
            <div style="display:flex;justify-content: space-between;">
                <div>
                    <p class="text-primary text-18 font-weight-bold">{{'bidderFinalInvoice.AuctionData' | translate}}
                    </p>
                </div>
                <div class="center-icon" (click)="downloadInvoice()">
                    <a class="text-primary text-18 font-weight-bold mt-2">
                        {{'sprint3_auction_detail.download_invoice' |
                        translate}}
                        <span *ngIf="!downloadingInvoice" class="icon-download text-18 mx-1"></span>
                        <!-- <img class="mx-2" *ngIf="!downloadingInvoice"
                            [src]="'assets/icons/download.svg'"> -->
                    </a>

                    <div *ngIf="downloadingInvoice"
                        class="spinner-border spinner-border-light-green icon-spinner text-light">
                    </div>
                </div>
            </div>
            <br>
            <div class="form-field">
                <form class="needs-validation" novalidate>
                    <div class="border-bottom">
                        <div class="form-row">
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label>{{'bidderFinalInvoice.AuctionReferenceNumber' | translate}}</label>
                                    <div class="text-primary">{{invoiceData?.ObjectId}}</div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label>{{'bidderFinalInvoice.AuctionStartDateandTime' | translate}}</label>
                                    <div class="text-primary">
                                        <span>{{ auctionStartDate }}</span>
                                        <ul class="list list-primary-bullets d-inline-block">
                                            <li class="text-muted"> {{auctionStartTime}} {{auctionStartSuffix |
                                                translate}} </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label>{{'bidderFinalInvoice.ProductsType' | translate}}</label>
                                    <div class="text-primary">
                                        {{invoiceData?.ZzAucProduct}}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label> {{'bidderFinalInvoice.OfferAwardDate' | translate}}</label>
                                    <div class="text-primary">
                                        <span>{{ offerDate }}</span>
                                        <ul class="list list-primary-bullets d-inline-block">
                                            <li class="text-muted"> {{ offerTime }} {{offerSuffix | translate}}
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="border-bottom d-flex mt-4">
                        <div class="w-50">
                            <p class="text-primary font-weight-bold text-18">
                                {{'bidderFinalInvoice.BillHolderInformation' | translate}}</p>
                            <div class="form-row mt-4">
                                <div class="col mb-3">
                                    <div class="form-group">
                                        <label>{{'bidderFinalInvoice.FacilityName' | translate}}</label>
                                        <div class="text-primary">{{invoiceData?.BidderName}}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row mt-4">
                                <div class="col mb-3">
                                    <div class="form-group">
                                        <label>{{'bidderFinalInvoice.CommercialRegistrationNo' | translate}}</label>
                                        <div class="text-primary">{{invoiceData?.CrNumber}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="w-50">
                            <p class="text-primary font-weight-bold text-18">
                                {{'bidderFinalInvoice.BillerData' | translate}}</p>
                            <div class="form-row mt-4">
                                <div class="col mb-3">
                                    <div class="form-group">
                                        <label>{{'bidderFinalInvoice.EntityName' | translate}}</label>
                                        <div class="text-primary">{{invoiceData?.ZzAgencyName}}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row mt-4">
                                <div class="col mb-3">
                                    <div class="form-group">
                                        <label>{{'bidderFinalInvoice.EntityNo' | translate}}</label>
                                        <div class="text-primary">{{invoiceData?.ZzAgencyId}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="invoiceData?.SameAddress == 'Y'" class="border-bottom mt-4 mb-4">
                        <p class="text-primary font-weight-bold text-18 mb-4">
                            {{'bidderFinalInvoice.DeliveryData' | translate}}</p>

                        <div class="form-row">
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label>{{'bidderFinalInvoice.DeliveryDate' | translate}}</label>
                                    <div class="text-primary">{{deliveryDate}}</div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label>{{'bidderFinalInvoice.Region' | translate}}</label>
                                    <div class="text-primary">{{invoiceData?.ZzRegion}}</div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label>{{'bidderFinalInvoice.City' | translate}}</label>
                                    <div class="text-primary">{{invoiceData?.ZzCity}}</div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label>{{'bidderFinalInvoice.District' | translate}}</label>
                                    <div class="text-primary">{{invoiceData?.ZzNeighbourhood}}</div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label>{{'bidderFinalInvoice.Street' | translate}}</label>
                                    <div class="text-primary">{{invoiceData?.ZzStreet}}</div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label>{{'bidderFinalInvoice.OtherNotes' | translate}}</label>
                                    <div class="text-primary">{{invoiceData?.ZzPdOthrNts}}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                </form>
            </div>


            <p class="text-primary text-18 font-weight-bold">
                {{'bidderFinalInvoice.TableOfProductsAndPrices' | translate}}</p>

            <table id="inventoryAllocationTable" class="table table-bordered table-expanded">
                <thead class="thead-dark">
                    <tr>
                        <th class="btn-primary-light" scope="col">
                            <div class="table-header-cell">
                                <span>#</span>
                            </div>
                        </th>
                        <th class="btn-primary-light" scope="col">
                            <div class="table-header-cell">
                                <span>{{'bidderFinalInvoice.ProductName' | translate}}</span>
                            </div>
                        </th>
                        <th class="btn-primary-light" scope="col">
                            <div class="table-header-cell">
                                <span>{{'bidderFinalInvoice.SKU_Number' | translate}}</span>
                            </div>
                        </th>
                        <th *ngIf="invoiceData?.SameAddress == 'N'" class="btn-primary-light" scope="col">
                            <div class="table-header-cell">
                                <span>{{'bidderFinalInvoice.DeliveryDate' | translate}}</span>
                            </div>
                        </th>
                        <th *ngIf="invoiceData?.SameAddress == 'N'" class="btn-primary-light" scope="col">
                            <div class="table-header-cell">
                                <span>{{'bidderFinalInvoice.DeliveryAdd' | translate}}</span>
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <ng-container *ngIf="invoiceData?.invoicetoprodnav.results.length > 0">
                        <tr *ngFor="let rowItem of invoiceData?.invoicetoprodnav.results; index as i;">
                            <ng-container
                                *ngIf="i >= pageRangeForProductAttach.rangeStart && i <= pageRangeForProductAttach.rangeEnd">
                                <td>{{i+1}}</td>
                                <td>{{rowItem.Description}}</td>
                                <td>{{rowItem.ZzProductSku}}</td>
                                <td *ngIf="invoiceData?.SameAddress == 'N'">{{rowItem.DelivDate}}</td>
                                <td *ngIf="invoiceData?.SameAddress == 'N'">{{rowItem.ZzRegion}}, {{rowItem.ZzCity}},
                                    {{rowItem.ZzNeighbourhood}},
                                    {{rowItem.ZzStreet}}</td>
                            </ng-container>
                        </tr>
                    </ng-container>
                    <ng-container *ngIf="invoiceData?.BidderValue">
                        <ng-container *ngIf="invoiceData?.SameAddress == 'N'">
                            <tr>
                                <td colspan="5">
                                    <span class="text-primary text-14 font-weight-bold">{{'bidderFinalInvoice.GearPrice'
                                        |
                                        translate}}</span>
                                    <span [ngStyle]="{float: textFloat}" class="text-success">{{gearPrice | number:
                                        '1.0-2'}}
                                        {{'bidderFinalInvoice.SAR' | translate}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="5">
                                    <span class="text-primary text-14 font-weight-bold">{{'bidderFinalInvoice.QuestRate'
                                        |
                                        translate}}</span>
                                    <span [ngStyle]="{float: textFloat}" class="text-success">{{questRate | number:
                                        '1.0-2'}}
                                        {{'bidderFinalInvoice.SAR' | translate}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="5">
                                    <span
                                        class="text-primary text-14 font-weight-bold">{{'bidderFinalInvoice.ValueAddedTax'
                                        | translate}}</span>
                                    <span [ngStyle]="{float: textFloat}" class="text-success">{{vat | number:
                                        '1.0-2'}}
                                        {{'bidderFinalInvoice.SAR' | translate}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="5">
                                    <span
                                        class="text-primary text-14 font-weight-bold">{{'bidderFinalInvoice.TotalInvoicePrice'
                                        | translate}}</span>
                                    <span [ngStyle]="{float: textFloat}" class="text-success">{{totalValue | number:
                                        '1.0-2'}}
                                        {{'bidderFinalInvoice.SAR' | translate}}</span>
                                </td>
                            </tr>
                        </ng-container>
                        <ng-container *ngIf="invoiceData?.SameAddress == 'Y'">
                            <tr>
                                <td colspan="3">
                                    <span class="text-primary text-14 font-weight-bold">{{'bidderFinalInvoice.GearPrice'
                                        |
                                        translate}}</span>
                                    <span [ngStyle]="{float: textFloat}" class="text-success">{{gearPrice | number:
                                        '1.0-2'}}
                                        {{'bidderFinalInvoice.SAR' | translate}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <span class="text-primary text-14 font-weight-bold">{{'bidderFinalInvoice.QuestRate'
                                        |
                                        translate}}</span>
                                    <span [ngStyle]="{float: textFloat}" class="text-success">{{questRate | number:
                                        '1.0-2'}}
                                        {{'bidderFinalInvoice.SAR' | translate}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <span
                                        class="text-primary text-14 font-weight-bold">{{'bidderFinalInvoice.ValueAddedTax'
                                        | translate}}</span>
                                    <span [ngStyle]="{float: textFloat}" class="text-success">{{vat | number:
                                        '1.0-2'}}
                                        {{'bidderFinalInvoice.SAR' | translate}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <span
                                        class="text-primary text-14 font-weight-bold">{{'bidderFinalInvoice.TotalInvoicePrice'
                                        | translate}}</span>
                                    <span [ngStyle]="{float: textFloat}" class="text-success">{{totalValue | number:
                                        '1.0-2'}}
                                        {{'bidderFinalInvoice.SAR' | translate}}</span>
                                </td>
                            </tr>
                        </ng-container>
                    </ng-container>
                </tbody>
            </table>

            <div class="mt-4 row justify-content-end" *ngIf="invoiceData?.invoicetoprodnav.results.length > 8">
                <div class="mb-5">
                    <nav aria-label="..." class="nav-pagination">
                        <ul class="pagination">
                            <li class="page-item clickable" disabled
                                [ngClass]="{disabled: pageRangeForProductAttach.currentPage===1}">
                                <a (click)=" navigateToPage( pageRangeForProductAttach.currentPage - 1 ) "
                                    class="page-link" aria-disabled="true">{{"auctionlist.grid-previous" |
                                    translate}}</a>
                            </li>
                            <li *ngFor="let page of pageRangeForProductAttach.pages" class="page-item"
                                [ngClass]="{active: pageRangeForProductAttach.currentPage===page}">
                                <a (click)="navigateToPage(page)" class="page-link">{{page}}</a>
                            </li>
                            <li class="page-item clickable" disabled
                                [ngClass]="{disabled: pageRangeForProductAttach.currentPage===pageRangeForProductAttach.totalPages}">
                                <a (click)=" navigateToPage( pageRangeForProductAttach.currentPage + 1 ) "
                                    class="page-link">{{"auctionlist.grid-next" | translate}}</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>

        </div>



    </div>

    <!-- Added by Mohammed Salick -->
    <div *ngIf="userRole != 'EAuction_AuctionManager'" style="width: 896px;"
        class="d-flex align-items-md-center align-items-stretch flex-column flex-md-row justify-content-between my-5 mb-5">
        <div class="mb-2 mb-md-5 flex-grow-1 flex-md-grow-0">
            <button (click)="goToAuctionDetails()" type="submit"
                class="btn arrow-btn arrow-btn-reverse btn-outline-light btn-lg btn-block">
                <span class="btn-text">{{'bidderSendInvoice.reference' | translate}}</span> <span
                    class="v-divider"></span> <span class="icon icon-arrow-left"></span>
            </button>
        </div>
        <div class="d-flex flex-column flex-md-row mb-5">
            <button *ngIf="invoiceData?.Status == 'Pending FBGA Approval'" data-toggle="modal"
                data-target="#showSuccessfulModal" data-backdrop="static"
                class="btn arrow-btn btn-primary-light btn-lg mt-2 mt-md-0"> <span
                    class="btn-text">{{'bidderSendInvoice.send_invoice' | translate}}</span> </button>
        </div>
    </div>

</div>




<!-- Confirmation pop-up for approval of the final award and send the invoice -->

<div class="modal fade" id="showSuccessfulModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true" data-keyboard="false">
    <div class="modal-dialog modal-md modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="exampleModalLabel">
                    {{'bidderSendInvoice.approval_of_the_final_award_title' | translate}}
                </h4>
                <button type="button" class="modal-close btn-close btn-sm" data-dismiss="modal" aria-label="Close"><span
                        class="icon-close"></span></button>
            </div>
            <div class="modal-body"><label for="confirmation"
                    class="text-body text-16">{{'bidderSendInvoice.approval_of_the_final_award_desc' |
                    translate}}</label></div>
            <div class="modal-footer" style="justify-content: end;">
                <button type="button" class="btn btn-lg btn-outline-light rounded" data-dismiss="modal"
                    aria-label="Close">
                    {{"bidderSendInvoice.reference" | translate}} </button>
                <button type="button" class="btn btn-primary-light btn-lg" data-dismiss="modal" aria-label="Close"
                    (click)="sendInvoice()">
                    {{'bidderSendInvoice.send_invoice' | translate}} </button>

            </div>
        </div>
    </div>
</div>


<!-- Success pop-up for approval of the final award and send the invoice -->

<div class="modal show" *ngIf="showSuccessPopup" [ngClass]="{ 'modal-show': showSuccessPopup }">
    <div class="modal-dialog modal-md modal-dialog-centered" role="document">
        <div class="modal-content align-items-md-center">

            <button (click)="closeSuccess()" style="outline: none;" type="button" class="modal-close btn-close btn-sm"
                data-dismiss="modal" aria-label="Close">
                <span class="icon-close"></span>
            </button>

            <span class="icon-check"></span>
            <div class="modal-header">
                <div class="status-success-icon">
                    <div style="display: flex;">
                        <div class="circle">
                        </div>
                    </div>
                    <h4 class="modal-title text-align-center mt-4" id="exampleModalLabel">
                        {{'bidderSendInvoice.invoice_sent_successfully' | translate}}</h4>
                </div>
            </div>
            <div class="modal-body"><label for="confirmation"
                    class="text-body text-16 text-align-center">{{'bidderSendInvoice.you_will_receive_invoice'
                    | translate}}</label></div>
            <div class="modal-footer justify-content-end">
                <button type="button" (click)="goBack()" class="btn btn-primary-light btn-md" data-dismiss="modal"
                    aria-label="Close">{{'bidderSendOffer.BackToAuctions' | translate}}</button>
            </div>
        </div>
    </div>
</div>